<!DOCTYPE html>
<html>
<head>
    <title>Stock Price Predictor</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 20px; }
        .container { background: white; padding: 25px; border-radius: 12px; width: 60%; margin: auto; box-shadow: 0 0 12px rgba(0,0,0,0.1); }
        .form-box { margin-bottom: 20px; }
        label { font-size: 16px; font-weight: bold; }
        select, input { padding: 10px; width: 100%; margin-top: 8px; border-radius: 8px; border: 1px solid #ccc; }
        button { background: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 8px; cursor: pointer; width: 100%; margin-top: 12px; font-size: 16px; }
        button:hover { background: #0056b3; }
        #result { margin-top: 25px; font-size: 20px; font-weight: bold; color: green; }
        .error { margin-top: 15px; font-size: 18px; color: red; }
    </style>
</head>

<body>
<div class="container">
    <h2>ðŸ“ˆ Stock Price Predictor</h2>

    <form method="POST" action="/">
        <div class="form-box">
            <label>Select Ticker</label>
            <select name="ticker" required>
                {% for t in tickers %}
                    <option value="{{ t }}" {% if selected_ticker==t %} selected {% endif %}>{{ t }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- âœ… UPDATED DATE SECTION -->
        <div class="form-box">
            <label>Select Date (Today or Future)</label>
            <input
                type="date"
                name="future_date"
                min="{{ today }}"
                required
                value="{{ future_date }}"
            >
        </div>

        <button type="submit">Predict Price</button>
    </form>

    {% if error_message %}
        <div class="error">{{ error_message }}</div>
    {% endif %}

    <div id="result">
        {% if predicted_price %}
            Predicted Price for <strong>{{ selected_ticker }}</strong> on <strong>{{ future_date }}</strong>:
            <br><br>
            <span style="font-size:28px;color:#1d7a1d;">$ {{ "%.2f"|format(predicted_price) }}</span>
        {% endif %}
    </div>

    <br><br>
    <h3>ðŸ“‰ Live Chart</h3>

    <!-- ðŸ”’ GRAPH LEFT UNCHANGED -->
    <div class="tradingview-widget-container">
        <div id="tradingview_live_chart" style="height:480px;"></div>
    </div>

    <script src="https://s3.tradingview.com/tv.js"></script>
    <script>
        new TradingView.widget({
            "container_id": "tradingview_live_chart",
            "width": "100%",
            "height": 480,
            "symbol": "{{ selected_ticker if selected_ticker else 'AAPL' }}",
            "interval": "1",
            "timezone": "Asia/Kolkata",
            "theme": "light",
            "style": "1",
            "locale": "en",
            "enable_publishing": false,
            "allow_symbol_change": true,
            "studies": ["MACD@tv-basicstudies"],
            "toolbar_bg": "#f1f3f6",
            "hide_side_toolbar": false,
            "withdateranges": true,
            "details": true,
            "hotlist": true,
            "calendar": true,
            "support_host": "https://www.tradingview.com"
        });
    </script>
</div>
</body>
</html>
